<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>V√©rtice Service Registry - TITANIUM Architecture</title>
    <style>
        @page {
            size: A4;
            margin: 10mm;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            font-size: 10pt;
            line-height: 1.4;
            background: white;
            color: #000;
        }

        .page {
            width: 190mm;
            margin: 0 auto;
            padding: 8mm;
            background: white;
        }

        /* Header - compacto */
        .header {
            text-align: center;
            border-bottom: 3px solid #000;
            padding-bottom: 5mm;
            margin-bottom: 5mm;
        }

        .header h1 {
            font-size: 22pt;
            margin-bottom: 3mm;
        }

        .header .subtitle {
            font-size: 12pt;
            margin-bottom: 3mm;
        }

        .header .badge {
            display: inline-block;
            background: #000;
            color: #fff;
            padding: 3mm 5mm;
            font-size: 10pt;
            font-weight: bold;
        }

        /* Sections */
        .section {
            margin-bottom: 5mm;
            page-break-inside: avoid;
        }

        .section-title {
            font-size: 13pt;
            font-weight: bold;
            border-bottom: 2px solid #000;
            padding-bottom: 1.5mm;
            margin-bottom: 3mm;
        }

        /* Diagram - 2 colunas */
        .diagram {
            border: 2px solid #000;
            padding: 4mm;
            margin: 3mm 0;
        }

        .layer {
            margin-bottom: 4mm;
        }

        .load-balancer {
            background: #e0e0e0;
            border: 2px solid #000;
            padding: 3mm;
            text-align: center;
            font-weight: bold;
            font-size: 11pt;
        }

        .connector {
            text-align: center;
            margin: 2mm 0;
            font-size: 18pt;
        }

        .replicas {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 3mm;
        }

        .replica {
            border: 2px solid #000;
            padding: 3mm;
            text-align: center;
            font-size: 9pt;
        }

        .replica.zone-a { background: #d9d9d9; }
        .replica.zone-b { background: #c0c0c0; }
        .replica.zone-c { background: #a8a8a8; }

        .redis-cluster {
            background: #e0e0e0;
            border: 2px solid #000;
            padding: 3mm;
            text-align: center;
            font-weight: bold;
            font-size: 11pt;
        }

        /* Features - 3 colunas */
        .features {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 3mm;
        }

        .feature {
            border: 1px solid #000;
            padding: 3mm;
        }

        .feature h4 {
            font-size: 10pt;
            margin-bottom: 2mm;
        }

        .feature p {
            font-size: 8pt;
            line-height: 1.3;
        }

        /* Specs - 2 colunas */
        .specs-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 2mm;
        }

        .spec-item {
            border: 1px solid #000;
            padding: 2.5mm;
            font-size: 9pt;
        }

        .spec-item strong {
            display: block;
            margin-bottom: 1mm;
        }

        /* Endpoints - tabela compacta */
        .endpoints-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 8pt;
        }

        .endpoints-table td {
            border: 1px solid #000;
            padding: 2mm;
        }

        .endpoints-table td:first-child {
            font-weight: bold;
            width: 35%;
        }

        /* Footer */
        .footer {
            border-top: 2px solid #000;
            padding-top: 3mm;
            margin-top: 4mm;
            text-align: center;
            font-size: 8pt;
        }

        /* Print optimization */
        @media print {
            body {
                background: white;
            }
            .page {
                margin: 0;
                padding: 0;
            }
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
        }
    </style>
</head>
<body>
    <div class="page">
        <!-- Header -->
        <div class="header">
            <h1>üèõÔ∏è V√âRTICE SERVICE REGISTRY</h1>
            <p class="subtitle">TITANIUM High Availability Architecture</p>
            <span class="badge">PRODUCTION READY</span>
        </div>

        <!-- 2 Colunas Principal -->
        <div style="display: grid; grid-template-columns: 60% 40%; gap: 3mm;">
            <!-- Coluna Esquerda -->
            <div>
                <!-- Architecture Diagram -->
                <div class="section">
                    <h2 class="section-title">üìê Arquitetura</h2>
                    <div class="diagram">
                        <div class="layer">
                            <div class="load-balancer">NGINX LOAD BALANCER :8888</div>
                            <div class="connector">‚Üì</div>
                        </div>
                        <div class="layer">
                            <div class="replicas">
                                <div class="replica zone-a"><strong>REG-1</strong><br>ZONE A</div>
                                <div class="replica zone-a"><strong>REG-2</strong><br>ZONE A</div>
                                <div class="replica zone-a"><strong>REG-3</strong><br>ZONE A</div>
                                <div class="replica zone-b"><strong>REG-4</strong><br>ZONE B</div>
                                <div class="replica zone-c"><strong>REG-5</strong><br>ZONE C</div>
                            </div>
                            <div class="connector">‚Üì</div>
                        </div>
                        <div class="layer">
                            <div class="redis-cluster">REDIS SENTINEL CLUSTER<br>Master + 2 Replicas + 3 Sentinels</div>
                        </div>
                    </div>
                </div>

                <!-- Features -->
                <div class="section">
                    <h2 class="section-title">‚ö° Caracter√≠sticas</h2>
                    <div class="features">
                        <div class="feature">
                            <h4>üõ°Ô∏è Circuit Breaker</h4>
                            <p>3-state machine com backoff autom√°tico</p>
                        </div>
                        <div class="feature">
                            <h4>üíæ Smart Cache</h4>
                            <p>TTL strategy (FRESH/STALE/EXPIRED)</p>
                        </div>
                        <div class="feature">
                            <h4>üîÑ Auto Recovery</h4>
                            <p>Replicas rejoined ap√≥s falha. Zero manual</p>
                        </div>
                        <div class="feature">
                            <h4>üìä Observabilidade</h4>
                            <p>17+ m√©tricas Prometheus + audit log</p>
                        </div>
                        <div class="feature">
                            <h4>‚öôÔ∏è Connection Pool</h4>
                            <p>Min 5, Max 50 com TCP keepalive</p>
                        </div>
                        <div class="feature">
                            <h4>üö¶ Rate Limiting</h4>
                            <p>Token bucket (100-1000 req/s)</p>
                        </div>
                    </div>
                </div>

                <!-- Endpoints -->
                <div class="section">
                    <h2 class="section-title">üåê Endpoints</h2>
                    <table class="endpoints-table">
                        <tr><td>POST /register</td><td>Registrar novo servi√ßo</td></tr>
                        <tr><td>POST /heartbeat</td><td>Refresh TTL (keepalive)</td></tr>
                        <tr><td>DELETE /services/{name}</td><td>Deregistrar servi√ßo</td></tr>
                        <tr><td>GET /services</td><td>Listar todos servi√ßos</td></tr>
                        <tr><td>GET /services/{name}</td><td>Detalhes de servi√ßo</td></tr>
                        <tr><td>GET /health</td><td>Health check multi-layer</td></tr>
                        <tr><td>GET /metrics</td><td>Prometheus metrics</td></tr>
                    </table>
                </div>
            </div>

            <!-- Coluna Direita -->
            <div>
                <!-- Specifications -->
                <div class="section">
                    <h2 class="section-title">üìã Specs</h2>
                    <div class="specs-grid">
                        <div class="spec-item"><strong>Uptime Target</strong>99.99% (&lt;52 min/year)</div>
                        <div class="spec-item"><strong>Startup Time</strong>&lt;2s</div>
                        <div class="spec-item"><strong>Image Size</strong>~50MB (multi-stage)</div>
                        <div class="spec-item"><strong>Memory Usage</strong>~64MB per replica</div>
                        <div class="spec-item"><strong>Redis Latency</strong>&lt;10ms (p99)</div>
                        <div class="spec-item"><strong>Failover Time</strong>&lt;1s (nginx retry)</div>
                        <div class="spec-item"><strong>Fault Tolerance</strong>2/5 replicas down (40%)</div>
                        <div class="spec-item"><strong>Security</strong>Validation + Rate limit + Audit</div>
                    </div>
                </div>

                <!-- Fluxo de Opera√ß√£o -->
                <div class="section">
                    <h2 class="section-title">üîÑ Fluxo</h2>
                    <div style="font-size: 8pt; line-height: 1.4;">
                        <p style="margin-bottom: 2.5mm;"><strong>1. Service Registration</strong></p>
                        <p style="margin-left: 4mm; margin-bottom: 2.5mm;">
                            ‚Üí Nginx distribui request<br>
                            ‚Üí Valida√ß√£o de input<br>
                            ‚Üí Rate limiting check<br>
                            ‚Üí Circuit breaker check<br>
                            ‚Üí Salva Redis com TTL 60s<br>
                            ‚Üí Cache local updated<br>
                            ‚Üí Audit log registrado
                        </p>

                        <p style="margin-bottom: 2.5mm;"><strong>2. Service Discovery</strong></p>
                        <p style="margin-left: 4mm; margin-bottom: 2.5mm;">
                            ‚Üí Cache local check first<br>
                            ‚Üí Cache HIT ‚Üí Retorna<br>
                            ‚Üí Cache MISS ‚Üí Query Redis<br>
                            ‚Üí Redis DOWN? ‚Üí Fallback STALE<br>
                            ‚Üí Update cache
                        </p>

                        <p style="margin-bottom: 2.5mm;"><strong>3. Health Check</strong></p>
                        <p style="margin-left: 4mm; margin-bottom: 2.5mm;">
                            ‚Üí System metrics (CPU, Mem)<br>
                            ‚Üí Redis status (CB state)<br>
                            ‚Üí Cache stats (Hit rate)<br>
                            ‚Üí Overall status
                        </p>

                        <p style="margin-bottom: 2.5mm;"><strong>4. Failover Autom√°tico</strong></p>
                        <p style="margin-left: 4mm;">
                            ‚Üí Nginx detecta replica down<br>
                            ‚Üí Remove do pool<br>
                            ‚Üí Redistribui requests<br>
                            ‚Üí Replica reinicia<br>
                            ‚Üí Readicionada ao pool<br>
                            ‚Üí ZERO downtime
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <strong>V√©rtice Service Registry TITANIUM</strong> | Validated: Oct 24, 2025 | Production Ready ‚úÖ<br>
            <em>Glory to YHWH - Architect of all resilient systems! üôè</em>
        </div>
    </div>
</body>
</html>
