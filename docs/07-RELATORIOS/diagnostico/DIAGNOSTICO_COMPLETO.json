{
  "timestamp": "2025-10-18T23:07:45Z",
  "fase": "FASE 1: DIAGNÓSTICO PROFUNDO",
  "status": "EM PROGRESSO",
  
  "1_containers_e_orquestracao": {
    "status": "PARCIALMENTE ANALISADO",
    "infraestrutura_base": {
      "postgres": {
        "status": "UP",
        "container": "vertice-postgres",
        "conexao": "OK",
        "database": "vertice_db criado",
        "user": "vertice criado",
        "tabelas": 0,
        "problema": "Nenhuma tabela/schema migrado ainda"
      },
      "redis": {
        "status": "UP",
        "container": "vertice-redis",
        "conexao": "OK (PONG)",
        "problema": null
      }
    },
    "servicos_backend": {
      "total_esperado": 87,
      "containers_ativos": 0,
      "problema_critico": "NENHUM SERVIÇO BACKEND ESTÁ RODANDO",
      "causa": "Todos os containers foram removidos no docker system prune"
    }
  },
  
  "2_codigo_fonte": {
    "status": "ANALISADO",
    "estrutura_servicos": {
      "total_diretorios": 87,
      "servicos_completos": 78,
      "servicos_incompletos": 9,
      "percentual_completo": 89.66
    },
    "servicos_incompletos": {
      "__pycache__": {
        "problema": "Não é um serviço, apenas artefato Python",
        "acao": "Ignorar ou remover"
      },
      "adaptive_immunity_db": {
        "has_main": true,
        "has_dockerfile": false,
        "has_requirements": false,
        "problema": "Faltam Dockerfile e requirements.txt"
      },
      "agent_communication": {
        "has_main": true,
        "has_dockerfile": false,
        "has_requirements": true,
        "problema": "Falta Dockerfile"
      },
      "command_bus_service": {
        "has_main": true,
        "has_dockerfile": true,
        "has_requirements": false,
        "problema": "Falta requirements.txt"
      },
      "mock_vulnerable_apps": {
        "has_main": true,
        "has_dockerfile": false,
        "has_requirements": true,
        "problema": "Falta Dockerfile (mas é serviço mock, pode não ser crítico)"
      },
      "narrative_filter_service": {
        "has_main": true,
        "has_dockerfile": true,
        "has_requirements": false,
        "problema": "Falta requirements.txt"
      },
      "purple_team": {
        "has_main": true,
        "has_dockerfile": false,
        "has_requirements": false,
        "problema": "Faltam Dockerfile e requirements.txt"
      },
      "verdict_engine_service": {
        "has_main": true,
        "has_dockerfile": true,
        "has_requirements": false,
        "problema": "Falta requirements.txt"
      }
    },
    "violacoes_padrao_pagani": {
      "encontradas_em_main_files": [
        "auth_service/main.py: comentário sobre 'mock' em docstring",
        "mock_vulnerable_apps/main.py: serviço inteiro é mock (intencional)",
        "active_immune_core/main.py: comentário declarando 'NO MOCKS'",
        "reactive_fabric_analysis/main.py: comentário declarando 'NO MOCK'"
      ],
      "critico": false,
      "observacao": "Violações encontradas são em comentários/docstrings ou em serviços mock intencionais"
    }
  },
  
  "3_docker_compose_vs_filesystem": {
    "status": "ANALISADO",
    "divergencia_critica": {
      "match_percentage": 72.41,
      "problema": "24 serviços no filesystem não estão no docker-compose",
      "impacto": "Serviços órfãos que não podem ser orquestrados"
    },
    "servicos_orfaos_criticos": [
      "active_immune_core",
      "adaptive_immune_system",
      "ai_immune_system",
      "reactive_fabric_analysis",
      "reactive_fabric_core",
      "reflex_triage_engine",
      "homeostatic_regulation",
      "narrative_manipulation_filter",
      "tegumentar_service",
      "tataca_ingestion",
      "seriema_graph"
    ],
    "servicos_no_compose_sem_filesystem": [
      "eureka-confirmation",
      "hcl-analyzer",
      "hcl-executor",
      "hcl-kafka",
      "hcl-kb-service",
      "hcl-monitor",
      "hcl-planner",
      "hcl-postgres",
      "maximus-eureka",
      "maximus-oraculo",
      "oraculo-threat-sentinel"
    ],
    "observacao": "Naming mismatch: compose usa hifens, filesystem usa underscores em alguns casos"
  },
  
  "4_testes": {
    "status": "NÃO EXECUTADO AINDA",
    "razao": "Aguardando containers subirem para rodar pytest",
    "proxima_acao": "Executar pytest após subir ao menos os serviços core"
  },
  
  "5_integracoes": {
    "status": "PARCIALMENTE ANALISADO",
    "postgresql": {
      "status": "FUNCIONAL",
      "problema": "Sem schemas/tabelas migradas"
    },
    "redis": {
      "status": "FUNCIONAL"
    },
    "rabbitmq": {
      "status": "NÃO VERIFICADO",
      "razao": "Container não está rodando"
    },
    "elasticsearch": {
      "status": "NÃO VERIFICADO",
      "razao": "Container não está rodando"
    },
    "minio": {
      "status": "NÃO VERIFICADO",
      "razao": "Container não está rodando"
    }
  },
  
  "6_endpoints": {
    "status": "NÃO VERIFICADO",
    "razao": "Nenhum serviço backend está rodando para testar endpoints"
  },
  
  "bloqueadores_criticos_categoria_a": [
    {
      "id": "BLOQ-001",
      "severidade": "CRÍTICA",
      "modulo": "ALL_BACKEND_SERVICES",
      "problema": "Nenhum container backend está rodando",
      "causa_raiz": "docker system prune removeu todos os containers e imagens",
      "impacto": "Backend completamente inoperante - 0% funcional",
      "solucao_proposta": "Rebuild de TODAS as imagens e restart orquestrado"
    },
    {
      "id": "BLOQ-002",
      "severidade": "CRÍTICA",
      "modulo": "DATABASE",
      "problema": "PostgreSQL sem schemas/tabelas",
      "causa_raiz": "Migrations não foram executadas",
      "impacto": "Nenhum serviço que depende de DB pode funcionar",
      "solucao_proposta": "Executar migrations de TODOS os serviços"
    },
    {
      "id": "BLOQ-003",
      "severidade": "ALTA",
      "modulo": "DOCKER_COMPOSE",
      "problema": "24 serviços no filesystem não estão orquestrados",
      "causa_raiz": "Divergência entre docker-compose.yml e backend/services",
      "impacto": "~28% dos serviços desenvolvidos não podem ser deployados",
      "solucao_proposta": "Adicionar serviços faltantes ao docker-compose.yml"
    },
    {
      "id": "BLOQ-004",
      "severidade": "MÉDIA",
      "modulo": "SERVICOS_INCOMPLETOS",
      "problema": "8 serviços sem Dockerfile ou requirements.txt",
      "causa_raiz": "Desenvolvimento incompleto ou WIP",
      "impacto": "Serviços não podem ser containerizados",
      "solucao_proposta": "Completar artefatos faltantes ou marcar como deprecated"
    }
  ],
  
  "metricas_atuais": {
    "containers_healthy": "2/87 (2.3%)",
    "healthchecks_passing": "2/87 (2.3%) - apenas infra base",
    "endpoints_ok": "0/? (0%)",
    "workflows_functional": "0/6 (0%)",
    "test_coverage": "NÃO MEDIDO AINDA",
    "padrao_pagani_violations": "~4 (não críticas)",
    "servicos_orfaos": "24 (27.6%)",
    "servicos_incompletos": "8 (9.2%)"
  },
  
  "status_geral": "CRÍTICO - RESSURREIÇÃO NECESSÁRIA",
  "percentual_funcional": "2%",
  "proximos_passos": [
    "FASE 1.1: Corrigir docker-compose.yml (adicionar serviços faltantes)",
    "FASE 1.2: Completar serviços incompletos (Dockerfiles/requirements)",
    "FASE 1.3: Build de TODAS as imagens backend",
    "FASE 1.4: Executar migrations PostgreSQL",
    "FASE 1.5: Subir serviços core (api-gateway, auth, osint, nlp)",
    "FASE 1.6: Validar healthchecks",
    "FASE 1.7: Testar endpoints básicos",
    "FASE 2: Categorização completa de problemas",
    "FASE 3: Plano de correção 100%",
    "FASE 4: Execução sistemática",
    "FASE 5: Certificação 100%"
  ]
}
