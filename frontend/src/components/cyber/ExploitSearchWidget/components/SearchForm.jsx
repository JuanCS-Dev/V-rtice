/**
 * CVE SEARCH FORM - Semantic Form for Exploit Search
 *
 * AI-FIRST DESIGN (Maximus Vision Protocol):
 * - <form> with role="search"
 * - <label> associated with input
 * - aria-describedby for hint and error
 * - aria-live for loading status
 *
 * WCAG 2.1 AAA Compliance:
 * - Labeled form controls
 * - Error messages associated
 * - Loading status announced
 * - Keyboard accessible
 *
 * @version 2.0.0 (Maximus Vision)
 * @see MAXIMUS_VISION_PROTOCOL_HTML_BLUEPRINT.md
 */

import React, { useState } from 'react';
import { Button } from '../../../shared/Button';
import { Input } from '../../../shared/Input';
import styles from './SearchForm.module.css';

export const SearchForm = ({ onSearch, loading, error }) => {
  const [cveId, setCveId] = useState('');

  const handleSubmit = (e) => {
    e.preventDefault();
    if (cveId.trim()) {
      onSearch(cveId);
    }
  };

  return (
    <div className={styles.searchSection}>
      <form
        onSubmit={handleSubmit}
        className={styles.searchForm}
        role="search"
        aria-label="CVE exploit search">

        <label htmlFor="cve-id-input" className={styles.visuallyHidden}>
          CVE ID
        </label>
        <Input
          id="cve-id-input"
          type="text"
          placeholder="CVE-2024-1234"
          value={cveId}
          onChange={(e) => setCveId(e.target.value)}
          disabled={loading}
          variant="cyber"
          size="lg"
          icon={<i className="fas fa-bug"></i>}
          error={error}
          aria-describedby="cve-search-hint cve-search-error"
          aria-invalid={error ? "true" : "false"}
        />
        <Button
          type="submit"
          variant="primary"
          size="lg"
          loading={loading}
          disabled={!cveId.trim()}
          icon={loading ? null : <i className="fas fa-search"></i>}
          aria-label="Search for CVE exploits">
          {loading ? 'BUSCANDO...' : 'BUSCAR'}
        </Button>
      </form>

      <p id="cve-search-hint" className={styles.hint}>
        <i className="fas fa-info-circle" aria-hidden="true"></i>
        Busca em 40K+ exploits (Exploit-DB, Metasploit, NVD)
      </p>

      {error && (
        <div id="cve-search-error" className={styles.error} role="alert">
          {error}
        </div>
      )}

      {loading && (
        <div className={styles.visuallyHidden} role="status" aria-live="polite">
          Searching for CVE exploits...
        </div>
      )}
    </div>
  );
};

export default SearchForm;
