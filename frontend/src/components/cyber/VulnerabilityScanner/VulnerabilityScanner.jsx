import React from 'react';
import { Alert } from '../../shared';
import { useVulnerabilityScanner } from './hooks/useVulnerabilityScanner';
import { AccessDenied } from './components/AccessDenied';
import { ScanForm } from './components/ScanForm';
import { ExploitForm } from './components/ExploitForm';
import { ActiveScanStatus } from './components/ActiveScanStatus';
import { ExploitsList } from './components/ExploitsList';
import styles from './VulnerabilityScanner.module.css';

/**
 * VulnerabilityScanner - Ferramenta ofensiva para descoberta e exploração
 * Requer permissão 'offensive' para acesso
 */
export const VulnerabilityScanner = () => {
  const {
    scanData,
    loading,
    hasOffensivePermission,
    startScan,
    executeExploit
  } = useVulnerabilityScanner();

  if (!hasOffensivePermission) {
    return <AccessDenied />;
  }

  return (
    <div className={styles.container}>
      {/* Header */}
      <div className={styles.header}>
        <div>
          <h2 className={styles.title}>🎯 Vulnerability Scanner</h2>
          <p className={styles.description}>
            Ferramenta ofensiva para descoberta e exploração de vulnerabilidades
          </p>
        </div>
        <Alert variant="warning" size="sm">
          ⚠️ Uso autorizado apenas para testes de segurança em sistemas próprios
        </Alert>
      </div>

      {/* Forms Grid */}
      <div className={styles.forms}>
        <ScanForm onSubmit={startScan} loading={loading.scan} />
        <ExploitForm
          exploits={scanData.exploits}
          onSubmit={executeExploit}
          loading={loading.exploit}
        />
      </div>

      {/* Active Scan Status */}
      {scanData.activeScan && (
        <ActiveScanStatus scan={scanData.activeScan} />
      )}

      {/* Available Exploits */}
      <ExploitsList
        exploits={scanData.exploits}
        loading={loading.exploits}
      />
    </div>
  );
};

export default VulnerabilityScanner;
