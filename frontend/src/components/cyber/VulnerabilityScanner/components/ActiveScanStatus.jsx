import React from 'react';
import { Badge } from '../../../shared';
import styles from './ActiveScanStatus.module.css';

const getStatusVariant = (status) => {
  const variants = {
    completed: 'success',
    failed: 'critical',
    running: 'warning',
    pending: 'cyber'
  };
  return variants[status] || 'default';
};

const getSeverityVariant = (severity) => {
  const variants = {
    critical: 'critical',
    high: 'high',
    medium: 'medium',
    low: 'cyber'
  };
  return variants[severity] || 'default';
};

export const ActiveScanStatus = ({ scan }) => {
  return (
    <div className={styles.container}>
      <h3 className={styles.title}>ðŸ“Š Scan Ativo</h3>

      <div className={styles.stats}>
        <div className={styles.statCard}>
          <div className={styles.statLabel}>Target</div>
          <div className={styles.statValue}>{scan.target}</div>
        </div>

        <div className={styles.statCard}>
          <div className={styles.statLabel}>Status</div>
          <Badge variant={getStatusVariant(scan.status)} size="md">
            {scan.status}
          </Badge>
        </div>

        <div className={styles.statCard}>
          <div className={styles.statLabel}>Vulnerabilidades</div>
          <div className={styles.statValue}>
            {scan.vulnerabilities?.length || 0}
          </div>
        </div>
      </div>

      {/* Vulnerabilities List */}
      {scan.vulnerabilities && scan.vulnerabilities.length > 0 && (
        <div className={styles.vulnerabilities}>
          <h4 className={styles.vulnTitle}>Vulnerabilidades Encontradas:</h4>
          <div className={styles.vulnList}>
            {scan.vulnerabilities.map((vuln, index) => (
              <div key={index} className={styles.vulnCard}>
                <div className={styles.vulnHeader}>
                  <span className={styles.vulnService}>{vuln.service}</span>
                  <Badge variant={getSeverityVariant(vuln.severity)} size="sm">
                    {vuln.severity}
                  </Badge>
                </div>
                <div className={styles.vulnDescription}>{vuln.description}</div>
              </div>
            ))}
          </div>
        </div>
      )}
    </div>
  );
};

export default ActiveScanStatus;
