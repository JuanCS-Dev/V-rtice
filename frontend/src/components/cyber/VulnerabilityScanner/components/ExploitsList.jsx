import React from 'react';
import { Badge, LoadingSpinner } from '../../../shared';
import styles from './ExploitsList.module.css';

const getSeverityVariant = (severity) => {
  const variants = {
    critical: 'critical',
    high: 'high',
    medium: 'medium',
    low: 'cyber'
  };
  return variants[severity] || 'default';
};

export const ExploitsList = ({ exploits, loading }) => {
  if (loading) {
    return (
      <div className={styles.container}>
        <h3 className={styles.title}>ðŸ”§ Exploits DisponÃ­veis</h3>
        <LoadingSpinner variant="cyber" size="md" />
      </div>
    );
  }

  return (
    <div className={styles.container}>
      <h3 className={styles.title}>ðŸ”§ Exploits DisponÃ­veis</h3>

      <div className={styles.grid}>
        {exploits.map(exploit => (
          <div key={exploit.id} className={styles.card}>
            <div className={styles.cardHeader}>
              <span className={styles.exploitName}>{exploit.name}</span>
              <Badge variant={getSeverityVariant(exploit.severity)} size="sm">
                {exploit.severity}
              </Badge>
            </div>
            <div className={styles.description}>{exploit.description}</div>
            {exploit.ports && exploit.ports.length > 0 && (
              <div className={styles.ports}>
                Portas: {exploit.ports.join(', ')}
              </div>
            )}
          </div>
        ))}
      </div>
    </div>
  );
};

export default ExploitsList;
